[gcode_macro axis_twist_calibration]
description: Heats bed, homes, and starts the 5-point Axis Twist wizard
gcode:
    {% set BED_TEMP = params.BED_TEMP|default(60)|float %}
    
    # 1. Heat Bed (Critical for twisted extrusions)
    {% if printer.heater_bed.temperature < BED_TEMP %}
        {action_respond_info("Heating bed to " ~ BED_TEMP ~ "C for calibration consistency...")}
        M190 S{BED_TEMP}
    {% else %}
        {action_respond_info("Bed is already hot. Proceeding...")}
    {% endif %}

    # 2. Home All Axes (if not already homed)
    {% if "xyz" not in printer.toolhead.homed_axes %}
        G28
    {% endif %}

    # 3. Start the Wizard
    # This initiates the tool. You must then use the UI to jog Z and Accept points.
    AXIS_TWIST_COMPENSATION_CALIBRATE SAMPLE_COUNT=5
